# CryptoLab4
Sungjae and David

CSci 4554 Lab 4: Diffie-Hellman key exchange<br />
Due Wednesday, December 5th at 11:59pm<br />
Overview and background<br />
This lab is done in groups of 2 or individually.

The purpose of the lab is to implement cryptographic algorithms based on the DLP problem and attacks on them.

Tasks for the lab

Task 1: 20 points total<br />
1) Each group finds a partner group (feel free to form cycles of three groups)
2) Each group generates a Diffie-Hellman public key:<br />
    1) Choose a safe prime p between 10000000 and 1000000000. A safe prime is a prime equal to 2q+1, where q is also a prime. The reason for using a safe prime is so that the group has a very large cyclic subgroup. We will later see how having only small cyclic subgroups makes it much easier to solve the DLP problem.<br /> 
    You will need a first to choose a smaller prime q, then compute 2q+1, and check if it is a prime as well. If it's not, try another q. You may use your own primality checker or methods in BigInteger class.
    2) Find a generator in the cyclic group mod p. To check if a number g is a generator, check that g^2 and g^q are both not equal to 1 (that is because the order of the group is 2q, so it only has cyclic subgroups of the orders 2 and q). This means that g does not belong to any of the cyclic subgroups of p, so it is a generator. 
    A small generator is fine. Use square-and-multiply for your computations and reduce modulo p after each step.<br />
3) Send your p and generator g to your partner group via the discussion on canvas (mark the message with your initials and theirs), then follow the Diffie-Hellman key exchange protocol to generate a shared key (send your A, receive their B).<br />
4) Use email (not the canvas) to verify that you got the same key.<br />
5) Use the p and g sent to you by your partner group to generate another shared key, also check it.

Task 2: 20 points total

As you are viewing communications by other groups in the canvas discussion, use any of the methods below to solve their DLP to find their a and b (since your numbers are small, and therefore not really secure, that should be possible).

Apply one the following methods: baby-step, giant-step method or Pollard's rho algorithm, to find a secret key for an DLP problem generated by another group.

What to submit

A record of all the steps that you did (computations, postings, etc).<br />
Your genrated keys<br />
All the keys that you broke (and explanation of how you broke them)<br />
All your code.

Answers for Task 1:
1) Our partner group was AK and KZ
2) To generate the Diffie-Hellman Public key we chose the safe prime p = 35530787 and generator g = 2 (See Main.java)
3) We posted these to the discussion on Canvas - Sent A = 170879926 and B = 30328638, Received A = 213962984 and B = 28406022
4) We verified privately that the keys we calculated were the same using our p: key = 27705812 
5) We verified privately that the keys we calculated were the same using their p: key = 6192400385

Answers for Task 2:
Data to test on:
MM: p = 47186099, g = 8
CM AP: p = 23834099, g = 3

If we had the time to get to this we would have liked to implement the following code from Wikipedia article on Pollard's rho algorithm:
https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm_for_logarithms

 Inputs a: a generator of G, b: an element of G
 Output An integer x such that ax = b, or failure

 Initialise a_0 ← 0, b_0 ← 0, x_0 ← 1 ∈ G, 

 i ← 1
 loop
     xi ← f(x_i-1), 
     ai ← g(x_i-1, a_i-1), 
     bi ← h(x_i-1, b_i-1)

     x_2i ← f(f(x_2i-2)), 
     a_2i ← g(f(x_2i-2), g(x_2i-2, a_2i-2)), 
     b_2i ← h(f(x_2i-2), h(x_2i-2, b_2i-2))

     if x_i = x_2i then
         r ← b_i - b_2i
         if r = 0 return failure
         x ← r^−1(a_2i - a_i) mod p
         return x
     else # x_i ≠ x_2i
         i ← i+1, 
         break loop
     end if
  end loop

This seems to be the most straightforward approach to finding the secret a and b values. We would have most likely completed this part in Python as the psudocode is most similar to that in my opinion.
